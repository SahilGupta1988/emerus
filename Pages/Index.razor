@page "/dashboard"
@attribute [Authorize(Roles = "Approver,Requestor")]

<PageTitle>Dashboard</PageTitle>

<div class="page-header">
    <h2>Onboarding Dashboard</h2>
    <p class="text-muted">High level view of contractor onboarding activity.</p>
</div>

<div class="row g-3 mb-4">
    <div class="col-md-3">
        <div class="card kpi-card">
            <div class="card-body">
                <div class="kpi-label">Open Requests</div>
                <div class="kpi-value">12</div>
                <div class="kpi-footnote">Submitted and in progress</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card kpi-card">
            <div class="card-body">
                <div class="kpi-label">Completed This Week</div>
                <div class="kpi-value">4</div>
                <div class="kpi-footnote">Provisioning done</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card kpi-card">
            <div class="card-body">
                <div class="kpi-label">Pending Vendor Action</div>
                <div class="kpi-value">3</div>
                <div class="kpi-footnote">Missing documents</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card kpi-card">
            <div class="card-body">
                <div class="kpi-label">Tasks Due Today</div>
                <div class="kpi-value">7</div>
                <div class="kpi-footnote">Across all facilities</div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span>Recent Contractor Requests</span>
        <a class="btn btn-sm btn-primary" href="onboarding/new">New Contractor</a>
    </div>
    <div class="card-body p-0 card-table-wrapper">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Contractor</th>
                    <th>Vendor</th>
                    <th>Facility</th>
                    <th>Start Date</th>
                    <th>Status</th>
                    <th class="text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var row in MockData)
                {
                    <tr>
                        <td>@row.ContractorName</td>
                        <td>@row.VendorName</td>
                        <td>@row.Facility</td>
                        <td>@row.StartDate.ToShortDateString()</td>
                        <td><span class="badge bg-info">@row.Status</span></td>
                        <td class="text-end">
                            <a href="onboarding/request/@row.Id" class="btn btn-sm btn-outline-secondary">View</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@code {
    public record DashboardRow(Guid Id, string ContractorName, string VendorName, string Facility, DateTime StartDate, string Status);

    private List<DashboardRow> MockData = new()
    {
        new DashboardRow(Guid.NewGuid(), "Jane Doe", "Acme Health Staffing", "Houston Neighborhood", DateTime.Today.AddDays(3), "Submitted"),
        new DashboardRow(Guid.NewGuid(), "John Smith", "MedTech Partners", "Mesa Neighborhood", DateTime.Today.AddDays(5), "In Progress"),
        new DashboardRow(Guid.NewGuid(), "Maria Garcia", "Global Clinical", "Phoenix Neighborhood", DateTime.Today.AddDays(10), "Draft")
    };
}
