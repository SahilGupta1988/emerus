@using Emerus.ETM.Admin.Pages
@attribute [Authorize(Roles = "Approver,Requestor")]

<div class="card-section">
    <h5>Review</h5>
    <p class="text-muted">Confirm that the information below is correct before submitting.</p>

    <!-- Demographics -->
    <h6 class="mt-3">Demographics</h6>
    <dl class="row">
        <dt class="col-md-3">Full name</dt>
        <dd class="col-md-9">@Demographics.PreferredFirstName @Demographics.PreferredLastName
            <small class="text-muted">(@Demographics.FirstName @Demographics.LastName)</small>
        </dd>

        <dt class="col-md-3">Contact</dt>
        <dd class="col-md-9">
            <div>@Demographics.PersonalEmail</div>
            <div>@Demographics.CellPhone</div>
        </dd>

        <dt class="col-md-3">Date of birth</dt>
        <dd class="col-md-9">@((Demographics.DateOfBirth is DateTime dt) ? dt.ToShortDateString() : "-")</dd>

        <dt class="col-md-3">Gender / Identity</dt>
        <dd class="col-md-9">@Demographics.Gender @if(!string.IsNullOrWhiteSpace(Demographics.Identity)){ <span class="text-muted"> - @Demographics.Identity</span> }</dd>

        <dt class="col-md-3">Address</dt>
        <dd class="col-md-9">
            <div>@Demographics.AddressLine1</div>
            @if (!string.IsNullOrWhiteSpace(Demographics.AddressLine2))
            {
                <div class="text-muted">@Demographics.AddressLine2</div>
            }
            <div>@Demographics.City, @Demographics.State @Demographics.Postal</div>
            <div>@Demographics.Country</div>
        </dd>
    </dl>

    <!-- Job -->
    <h6 class="mt-4">Job & Dates</h6>
    <dl class="row">
        <dt class="col-md-3">Job title</dt>
        <dd class="col-md-9">@JobInfo.JobTitle</dd>

        <dt class="col-md-3">Department</dt>
        <dd class="col-md-9">@JobInfo.Department</dd>

        <dt class="col-md-3">Agency / Job code</dt>
        <dd class="col-md-9">@JobInfo.AgencyName @if(!string.IsNullOrWhiteSpace(JobInfo.JobCode)){ <span class="text-muted"> - @JobInfo.JobCode</span> }</dd>

        <dt class="col-md-3">External ID</dt>
        <dd class="col-md-9">@JobInfo.ExternalEmployeeId</dd>

        <dt class="col-md-3">Prior employee</dt>
        <dd class="col-md-9">@((JobInfo.PriorEmployeeFlag) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Start date</dt>
        <dd class="col-md-9">@((JobInfo.StartDate is DateTime sd) ? sd.ToShortDateString() : "-")</dd>
    </dl>

    <!-- Access -->
    <h6 class="mt-4">Access Requests</h6>
    @if (AccessInfo.RequestedTargets is null || !AccessInfo.RequestedTargets.Any())
    {
        <p class="text-muted">No access requested.</p>
    }
    else
    {
        <ul class="list-group">
            @foreach (var rt in AccessInfo.RequestedTargets)
            {
                <li class="list-group-item">
                    @* Render a sensible summary for the requested target. Show TargetId if no display name is available. *@
                    @if (rt is not null)
                    {
                        <div class="d-flex justify-content-between">
                            <div>Target: @rt.TargetId</div>
                            <small class="text-muted">RequestId: @rt.RequestId</small>
                        </div>
                    }
                </li>
            }
        </ul>
    }

    <!-- Hardware -->
    <h6 class="mt-4">Hardware</h6>
    <dl class="row">
        <dt class="col-md-3">Laptop</dt>
        <dd class="col-md-9">@((Hardware.NeedsLaptop) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Dock</dt>
        <dd class="col-md-9">@((Hardware.NeedsDock) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Monitors</dt>
        <dd class="col-md-9">@Hardware.MonitorCount</dd>

        <dt class="col-md-3">Headset</dt>
        <dd class="col-md-9">@((Hardware.NeedsHeadset) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Hotspot</dt>
        <dd class="col-md-9">@((Hardware.NeedsHotspot) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Notes</dt>
        <dd class="col-md-9">@(!string.IsNullOrWhiteSpace(Hardware.Notes) ? Hardware.Notes : "<span class=\"text-muted\">None</span>")</dd>
    </dl>

    <!-- Badge -->
    <h6 class="mt-4">Badge</h6>
    <dl class="row mb-0">
        <dt class="col-md-3">Requested</dt>
        <dd class="col-md-9">@((Badge.NeedsBadge) ? "Yes" : "No")</dd>

        <dt class="col-md-3">Facility</dt>
        <dd class="col-md-9">@Badge.PrimaryFacility</dd>

        <dt class="col-md-3">Access level</dt>
        <dd class="col-md-9">@Badge.RequestType</dd>
    </dl>
</div>

@code {
    [Parameter]
    public OnboardingNew.DemographicsModel Demographics { get; set; } = default!;

    [Parameter]
    public OnboardingNew.JobModel JobInfo { get; set; } = default!;

    [Parameter]
    public OnboardingNew.AccessModel AccessInfo { get; set; } = default!;

    [Parameter]
    public OnboardingNew.HardwareModel Hardware { get; set; } = default!;

    [Parameter]
    public OnboardingNew.BadgeModel Badge { get; set; } = default!;
}
